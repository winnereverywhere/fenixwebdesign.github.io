function bricksAdminClassicEditor(){var e=document.getElementById("bricks-editor"),t=document.getElementById("postdivrich");if(e&&t){var i=document.createElement("button");i.type="button",i.id="switch-bricks",i.classList.add("wp-switch-editor","switch-bricks"),i.innerText=window.bricksData.title;var a=t.querySelector(".wp-editor-tabs");a&&a.appendChild(i),e.after(t),document.addEventListener("click",(function(i){"switch-bricks"===i.target.id?(i.preventDefault(),i.stopPropagation(),t.style.display="none",e.style.display="block",document.getElementById("bricks-editor-mode").value="bricks"):-1!==["content-html","content-tmce"].indexOf(i.target.id)&&(t.style.display="block",e.style.display="none",document.getElementById("bricks-editor-mode").value="wordpress")})),window.bricksData.renderWithBricks&&i.click()}}function bricksAdminImport(){var e=document.getElementById("bricks-admin-import-form");if(e){var t=document.querySelector("#wpbody-content .page-title-action");if(t){var i=document.getElementById("bricks-admin-template-tags");i&&t.after(i);var a=document.getElementById("bricks-admin-template-bundles");a&&t.after(a);var n=document.getElementById("bricks-admin-import-action");n&&t.after(n);var s=document.getElementById("bricks-admin-import-form-wrapper");t.after(s),document.querySelectorAll(".bricks-admin-import-toggle").forEach((function(e){e.addEventListener("click",(function(){s.style.display="block"===s.style.display?"none":"block"}))}));var r=document.querySelector("#bricks-admin-import-form-wrapper .import-progress");e.addEventListener("submit",(function(t){t.preventDefault();for(var i=new FormData(e),a=document.getElementById("bricks_import_files").files,n=0;n<a.length;n++){var s=a[n];i.append("files["+n+"]",s)}jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:i,processData:!1,contentType:!1,beforeSend:()=>{e.setAttribute("disabled","disabled"),r&&r.classList.add("is-active")},success:function(t){e.removeAttribute("disabled"),r&&r.classList.remove("is-active"),location.reload()}})}))}}}function bricksAdminSaveLicenseKey(){var e=document.getElementById("bricks-license-key-form");if(e){var t=e.action.value,i=e.nonce.value,a=e.querySelector("input[type=submit]");e.addEventListener("submit",(function(n){n.preventDefault(),a.disabled=!0;var s=e.license_key.value;jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:t,licenseKey:s,nonce:i},success:function(i){"bricks_deactivate_license"===t?location.reload():"bricks_activate_license"===t&&(i.success?(i.data.hasOwnProperty("message")&&(e.querySelector(".success-message").innerHTML=i.data.message),setTimeout((()=>{location.reload()}),1e3)):(a.disabled=!1,i.data.hasOwnProperty("message")&&(e.querySelector(".error-message").innerHTML=i.data.message)))}})}))}}function bricksAdminToggleLicenseKey(){var e=document.getElementById("bricks-toggle-license-key");e&&e.addEventListener("click",(function(e){e.preventDefault(),e.target.classList.contains("dashicons-hidden")?(e.target.classList.remove("dashicons-hidden"),e.target.classList.add("dashicons-visibility"),e.target.previousElementSibling.type="text"):(e.target.classList.remove("dashicons-visibility"),e.target.classList.add("dashicons-hidden"),e.target.previousElementSibling.type="password")}))}function bricksAdminSettings(){var e=document.querySelector("#bricks-settings");if(e){for(var t=document.querySelectorAll("#bricks-settings-tabs-wrapper a"),i=e.querySelectorAll("table"),a=0;a<t.length;a++)t[a].addEventListener("click",(function(e){e.preventDefault();var i=e.target.getAttribute("data-tab-id");if(i){location.hash=i,window.scrollTo({top:0});for(var a=0;a<t.length;a++)t[a].classList.remove("nav-tab-active");e.target.classList.add("nav-tab-active"),u(i)}}));var n=location.hash.replace("#","");if(n){var s=document.querySelector('[data-tab-id="'+n+'"]');s&&s.click()}var r=e.querySelector(".submit-wrapper"),c=e.querySelector(".spinner.saving");if(e){e.addEventListener("submit",(function(e){e.preventDefault()}));var o=e.querySelector('input[name="save"]');o&&o.addEventListener("click",(function(){r&&r.remove(),c&&c.classList.add("is-active"),window.jQuery.ajax({type:"POST",url:window.bricksData.ajaxUrl,data:{action:"bricks_save_settings",formData:window.jQuery(e).serialize(),nonce:window.bricksData.nonce},success:function(){let e=window.location.hash;window.location.href=window.location.search+=`&bricks_notice=settings_saved${e}`}})}));var l=e.querySelector('input[name="reset"]');l&&l.addEventListener("click",(function(){confirm(window.bricksData.i18n.confirmResetSettings)&&(r&&r.remove(),c&&c.classList.add("is-active"),window.jQuery.ajax({type:"POST",url:window.bricksData.ajaxUrl,data:{action:"bricks_reset_settings",nonce:window.bricksData.nonce},success:function(){window.location.href=window.location.search+="&bricks_notice=settings_resetted"}}))}));var d=e.querySelector('input[name="executeCodeEnabled"]');d&&d.addEventListener("click",(function(t){e.querySelectorAll('input[name^="executeCodeCapabilities"').forEach((function(e){e.disabled=!t.target.checked}))}))}}function u(e){document.getElementById(e);for(var t=0;t<i.length;t++){var a=i[t];a.getAttribute("id")===e?a.classList.add("active"):a.classList.remove("active")}}}function bricksAdminGenerateCssFiles(){button=document.querySelector("#bricks-css-loading-generate button"),button&&button.addEventListener("click",(function(e){e.preventDefault(),button.setAttribute("disabled","disabled"),button.classList.add("wait");var t=document.querySelector("#bricks-css-loading-generate .results");if(t){t.classList.remove("hide");var i=t.querySelector("ul"),a=t.querySelector(".count"),n=t.querySelector(".done");i.innerHTML="",a.innerHTML=0,n&&n.remove();var s=t.querySelector(".end");s&&s.remove()}jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_get_css_files_list",nonce:bricksData.nonce},success:function(e){bricksAdminGenerateCssFile(0,i,a,e.data)}})}))}function bricksAdminCodeReview(){let e="individual";const t=document.querySelector(".bricks-code-review-description"),i=document.querySelector(".bricks-code-review-action.show-all"),a=document.querySelector(".bricks-code-review-action.individual"),n=document.querySelectorAll(".bricks-code-review-item"),s=document.querySelector(".bricks-code-review-action.prev"),r=document.querySelector(".bricks-code-review-action.next"),c=document.querySelectorAll(".bricks-code-review-item-check");if(!i||!n||!a)return;const o=(e="up")=>{let t=document.querySelector(".bricks-code-review-total-reviewed"),i=t.innerText;i=i?parseInt(i):1,"up"===e?i++:i--,t&&(t.innerText=i)};i.addEventListener("click",(function(c){c.preventDefault(),e="all",t.classList.add("action-hide"),i.classList.add("action-hide"),a.classList.remove("action-hide"),s.classList.add("action-hide"),r.classList.add("action-hide"),n.forEach((function(e){e.classList.remove("item-hide")}))})),a.addEventListener("click",(function(c){c.preventDefault(),e="individual",t.classList.remove("action-hide"),a.classList.add("action-hide"),i.classList.remove("action-hide"),s.classList.remove("action-hide"),r.classList.remove("action-hide"),n.forEach((function(e){e.classList.add("item-hide")}));let o=document.querySelector(".bricks-code-review-item.item-current");o&&o.classList.remove("item-hide")})),s.addEventListener("click",(function(e){e.preventDefault();let t=document.querySelector(".bricks-code-review-item.item-current"),i=t.previousElementSibling;i&&(t.classList.remove("item-current"),t.classList.add("item-hide"),i.classList.add("item-current"),i.classList.remove("item-hide"),o("down"))})),r.addEventListener("click",(function(e){e.preventDefault();let t=document.querySelector(".bricks-code-review-item.item-current"),i=t.nextElementSibling;i&&(t.classList.remove("item-current"),t.classList.add("item-hide"),i.classList.add("item-current"),i.classList.remove("item-hide"),o("up"))})),c.length&&c.forEach((function(t){t.addEventListener("click",(function(i){i.preventDefault();let a=t.closest(".bricks-code-review-item");a&&(a.classList.add("item-marked"),o(),"individual"===e&&setTimeout((()=>{r.click()}),400))}))}))}function bricksAdminBreakpointsRegenerateCssFiles(){let e=document.getElementById("breakpoints-regenerate-css-files");if(!e)return;let t=e.querySelector("i");e.addEventListener("click",(function(i){i.preventDefault(),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_regenerate_bricks_css_files",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait"),t.classList.add("hide")},success:function(i){e.removeAttribute("disabled"),e.classList.remove("wait"),t.classList.remove("hide")}})}))}function bricksAdminGenerateCssFile(e,t,i,a){return jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_regenerate_css_file",data:a[e],index:e},success:function(e){var a=!!e.data.hasOwnProperty("file_name")&&e.data.file_name;if(a){var n="",s=i?parseInt(i.innerText):0;Array.isArray(a)?a.forEach((function(e){n+="<li>"+e+"</li>",s++})):(n+="<li>"+a+"</li>",s++),e.success||(n=n.replace("<li>",'<li class="error">')),t&&t.insertAdjacentHTML("afterbegin",n),i&&(i.innerText=s)}}}).then((function(n){if(e===a.length){var s=document.querySelector("#bricks-css-loading-generate button");s.removeAttribute("disabled"),s.classList.remove("wait");var r=document.querySelector("#bricks-css-loading-generate .info");r&&r.remove(),t&&t.insertAdjacentHTML("beforebegin",'<div class="done">... THE END :)</div>')}else bricksAdminGenerateCssFile(e+1,t,i,a)}))}function bricksAdminRunConverter(){var e=document.querySelectorAll(".bricks-run-converter");e.length&&e.forEach((function(e){e.addEventListener("click",(function(t){t.preventDefault();let i={action:"bricks_get_converter_items",nonce:bricksData.nonce,convert:[]};"bricks-run-converter-global-elements"===e.id&&i.convert.push("globalElementsToComponents"),document.getElementById("convert_element_ids_classes").checked&&i.convert.push("elementClasses"),document.getElementById("convert_container").checked&&i.convert.push("container"),document.getElementById("add_position_relative").checked&&i.convert.push("addPositionRelative"),document.getElementById("entry_animation_to_interaction").checked&&i.convert.push("entryAnimationToInteraction"),i.convert.length&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:i,beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:e=>{console.info("bricks_get_converter_items",e.data);bricksAdminConvert(0,e.data.items,e.data.convert)}})}))}))}function bricksAdminConvert(e,t,i){return jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_run_converter",nonce:bricksData.nonce,data:t[e],convert:i},success:function(a){var n=document.querySelector(".bricks-run-converter[disabled]"),s=n.parentNode.querySelector(".results");if(s)s&&0===e&&(s.querySelector("ul").innerHTML="");else{(s=document.createElement("div")).classList.add("results");var r=document.createElement("ul");s.appendChild(r),n.parentNode.appendChild(s)}var c,o=!!a.data.hasOwnProperty("label")&&a.data.label;o&&((c=document.createElement("li")).innerHTML=o,s.querySelector("ul").prepend(c));(console.warn("run_converter",e,o,a.data),e===t.length)?(n.removeAttribute("disabled"),n.classList.remove("wait"),(c=document.createElement("li")).classList.add("done"),c.innerText="... THE END :)",s.querySelector("ul").prepend(c)):bricksAdminConvert(e+1,t,i)}})}function bricksTemplateShortcodeCopyToClipboard(){var e=document.querySelectorAll(".bricks-copy-to-clipboard");e&&e.forEach((function(e){e.addEventListener("click",(function(t){if(navigator.clipboard){if(!window.isSecureContext)return void alert("Clipboard API rejected: Not in secure context (HTTPS)");if(e.classList.contains("copied"))return void t.preventDefault();var i=e.value,a=e.getAttribute("data-success");navigator.clipboard.writeText(i),e.value=a,e.classList.add("copied"),setTimeout((function(){e.value=i,e.classList.remove("copied")}),2e3)}}))}))}function bricksDismissHttpsNotice(){setTimeout((()=>{let e=document.querySelector(".brxe-https-notice .notice-dismiss");e&&e.addEventListener("click",(function(){jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_dismiss_https_notice",nonce:bricksData.nonce}})}))}),400)}function bricksDropFormSubmissionsTable(){let e=document.getElementById("bricks-drop-form-db");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.i18n.confirmDropFormSubmissionsTable)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_form_submissions_drop_table",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),location.reload()}})}))}function bricksResetFormSubmissionsTable(){let e=document.getElementById("bricks-reset-form-db");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.i18n.confirmResetFormSubmissionsTable)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_form_submissions_reset_table",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),location.reload()}})}))}function bricksDeleteFormSubmissionsByFormId(){if(!document.body.classList.contains("bricks_page_bricks-form-submissions"))return;let e=document.querySelectorAll(".column-actions [data-form-id]");for(var t=0;t<e.length;t++){let i=e[t];i.addEventListener("click",(function(e){e.preventDefault();let t=i.getAttribute("data-form-id");confirm(bricksData.i18n.confirmResetFormSubmissionsFormId.replace("[form_id]",`"${t}"`))&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_form_submissions_delete_form_id",nonce:bricksData.nonce,formId:t},beforeSend:()=>{i.setAttribute("disabled","disabled"),i.classList.add("wait")},success:function(e){i.removeAttribute("disabled"),i.classList.remove("wait"),alert(e.data.message),location.reload()}})}))}}function bricksDismissInstagramAccessTokenNotice(){setTimeout((()=>{let e=document.querySelector(".brxe-instagram-token-notice .notice-dismiss");e&&e.addEventListener("click",(function(){jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_dismiss_instagram_access_token_notice",nonce:bricksData.nonce}})}))}),400)}function bricksRemoteTemplateUrls(){let e=document.getElementById("add-remote-template-button");e&&e.addEventListener("click",(function(e){e.preventDefault();let t=document.querySelectorAll(".remote-template-wrapper"),i=t[t.length-1];if(!i)return;let a=i.cloneNode(!0);a.querySelectorAll("label").forEach((e=>{e.setAttribute("for",e.getAttribute("for").replace(/\[(\d+)\]/,(function(e,t){return"["+(parseInt(t)+1)+"]"})))})),a.querySelectorAll("input").forEach((e=>{e.value="",e.name=e.name.replace(/\[(\d+)\]/,(function(e,t){return"["+(parseInt(t)+1)+"]"})),e.id=e.id.replace(/\[(\d+)\]/,(function(e,t){return"["+(parseInt(t)+1)+"]"}))})),i.after(a)}))}function bricksDeleteTemplateScreenshots(){let e=document.getElementById("delete-template-screenshots-button");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.i18n.confirmDeleteTemplateScreenshots)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_delete_template_screenshots",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),t.success&&location.reload()}})}))}function bricksReindexFilters(){let e=document.getElementById("bricks-reindex-filters"),t=document.querySelector(".indexer-progress"),i=document.getElementById("bricks-run-index-job");e&&t&&i&&e.addEventListener("click",(function(a){a.preventDefault(),confirm(bricksData.i18n.confirmReindexFilters)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_reindex_query_filters",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(a){e.removeAttribute("disabled"),e.classList.remove("wait"),a.success?(t.innerText=a.data.message,setTimeout((()=>{i.setAttribute("data-no-confirm","true"),i.click()}),500)):console.error("bricks_reindex_query_filters:error",a.data)}})}))}function bricksRunIndexJob(){let e=document.getElementById("bricks-run-index-job"),t=document.querySelector(".indexer-progress"),i=!!e&&e.querySelector("i"),a=document.getElementById("bricks-remove-jobs-wrapper"),n=document.getElementById("bricks-remove-index-jobs"),s=document.getElementById("bricks-query-filter-td"),r=!1;if(!(e&&t&&i&&n&&a))return;const c=()=>{jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_run_index_job",nonce:bricksData.nonce},success:function(n){let s=n?.data?.progress||!1,o=n?.data?.pending||!1;t&&s&&(t.innerHTML=s),0==o||r?(e.removeAttribute("disabled"),e.classList.remove("wait"),i.classList.remove("hide"),r&&o>0&&a.classList.remove("hide")):setTimeout((()=>{c()}),3e3)},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait"),a.classList.add("hide")}})};e.classList.contains("wait")&&c(),e.addEventListener("click",(function(t){if((t.preventDefault(),!e.getAttribute("data-no-confirm"))&&!confirm(bricksData.i18n.confirmTriggerIndexJob))return;c(),e.removeAttribute("data-no-confirm"),i.classList.add("hide"),a.classList.add("hide")})),n.addEventListener("click",(function(e){e.preventDefault(),confirm(bricksData.i18n.confirmRemoveAllIndexJobs)&&(r=!0,jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_remove_all_index_jobs",nonce:bricksData.nonce},success:function(e){e.success&&setTimeout((()=>{alert(e.data.message),location.reload()}),1e4)},beforeSend:()=>{n.setAttribute("disabled","disabled"),n.classList.add("wait"),s.classList.add("blocking");let e=document.createElement("div");e.classList.add("blocking-info-wrapper"),e.innerHTML=`<p class="message info">${bricksData.i18n.removingIndexJobsInfo}</p>`,s.appendChild(e)}}))}))}function bricksFixElementDB(){let e=document.getElementById("bricks-fix-filter-element-db");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.i18n.confirmFixElementDB)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_fix_filter_element_db",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),location.reload()}})}))}function bricksRegenerateCodeSignatures(){let e=document.getElementById("bricks-regenerate-code-signatures");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.i18n.confirmRegenerateCodeSignatures)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_regenerate_code_signatures",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),t.success?location.reload():console.error("bricks_regenerate_code_element_signatures:error",t.data)}})}))}function bricksAdminCodeReviewFilter(){let e=document.getElementById("code-review-filter");e&&e.addEventListener("change",(e=>{let t=new URL(window.location.href);t.searchParams.set("code-review",e.target.value),window.location.href=t.toString()}))}function bricksAdminGlobalElementsReview(){document.querySelectorAll(".bricks-convert-global-elements").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();let i=!1,a=t.target.closest(".bricks-code-review-item");a&&a.querySelector(".nestable")&&(i=confirm(window.bricksData.i18n.globalElementsConvertConfirm)),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_convert_global_elements",nonce:bricksData.nonce,postId:e.getAttribute("data-post-id"),unlinkNestables:i},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:t=>{e.removeAttribute("disabled"),e.classList.remove("wait"),t.data.message&&alert(t.data.message),location.reload()}})}))}))}function bricksAdminMaintenanceTemplateListener(){let e=document.getElementById("maintenance-template"),t=document.getElementById("maintenance-template-section"),i=document.getElementById("maintenance-render-section");function a(){""===e.value?(i.style.display="none",t.style.borderBottom="none"):(i.style.display="block",t.style.borderBottom="1px solid var(--admin-color-border)")}i&&(a(),e.addEventListener("change",a))}function bricksTemplateThumbnailAddScrollAnimation(){document.querySelectorAll(".template_thumbnail a").forEach((e=>{const t=e.querySelector("img");function i(){const i=t.getBoundingClientRect().height,n=e.getBoundingClientRect().height;if(i>n){const s=n-i,r=function(e){const t=2e3,i=200;return Math.abs(e)*t/i}(s);e.classList.add("scroll"),e.addEventListener("mouseenter",(()=>{a(t,0,s,r)})),e.addEventListener("mouseleave",(()=>{const e=parseFloat(t.style.top)||s;a(t,e,0,r)}))}}function a(e,t,i,a){let n,s;cancelAnimationFrame(n),n=requestAnimationFrame((function r(c){s||(s=c);const o=c-s,l=Math.min(o/a,1);e.style.top=t+(i-t)*l+"px",l<1&&(n=requestAnimationFrame(r))}))}t.addEventListener("load",i),t.complete&&i()}))}function bricksAdminAuthUrlBehaviorListener(){let e=document.getElementById("wp_auth_url_behavior"),t=document.getElementById("wp_auth_url_redirect_page_wrapper");function i(){"custom"===e.value?t.style.display="block":t.style.display="none"}e&&t&&(i(),e.addEventListener("change",i))}function bricksAdminWooSettings(){let e=document.getElementById("woocommerceAjaxErrorAction"),t=document.getElementById("wooAjaxErrorScrollToNotice");e&&t&&e.addEventListener("change",(function(e){"notice"===e.target.value?t.classList.remove("hide"):t.classList.add("hide")}))}function bricksCreateMultiselect(e,t={}){const i=document.getElementById(e),a=i?.parentElement;if(!i||!a)return;const n={placeholder:window.bricksData?.i18n?.selectItems,searchPlaceholder:window.bricksData?.i18n?.searchItems,dataAttribute:"data-item-id",ajaxSearch:!1,ajaxOptions:{action:"bricks_get_posts",params:{},minSearchLength:2,debounceTime:300}},s={...n,...t};t.ajaxOptions&&(s.ajaxOptions={...n.ajaxOptions,...t.ajaxOptions});const r=document.createElement("div");r.setAttribute("data-control","select"),r.className="multiple bricks-multiselect",r.setAttribute("tabindex","0");const c=document.createElement("div");c.className="input";const o=document.createElement("div");o.className="options-wrapper";const l=document.createElement("div");l.className="searchable-wrapper",l.innerHTML=`\n\t\t<input class="searchable" type="text" spellcheck="false" placeholder="${s.searchPlaceholder}">\n\t\t<span class="search-status"></span>\n\t`;const d=document.createElement("ul");if(d.className="dropdown",s.ajaxSearch){if(u(),0===Array.from(i.selectedOptions).length){const e=document.createElement("li");e.className="message",e.innerHTML=`<span>${window.bricksData?.i18n?.typeToSearch}</span>`,d.appendChild(e)}}else d.innerHTML="",Array.from(i.options).forEach(((e,t)=>{const i=document.createElement("li");i.setAttribute("data-index",t),i.setAttribute("data-value",e.value),i.className=e.selected?"selected":"",i.innerHTML=`<span>${e.text}</span>`,d.appendChild(i)}));function u(){d.innerHTML="",Array.from(i.selectedOptions).forEach(((e,t)=>{const i=document.createElement("li");i.setAttribute("data-index",t),i.setAttribute("data-value",e.value),i.className="selected",i.innerHTML=`<span>${e.text}</span>`,d.appendChild(i)}))}o.appendChild(l),o.appendChild(d),r.appendChild(c),r.appendChild(o),i.style.display="none",i.after(r);const m=()=>{c.innerHTML="",c.className="input";const e=Array.from(i.selectedOptions);e.length?(c.classList.add("has-value"),e.forEach((e=>{const t=document.createElement("span");t.className="value",t.setAttribute(s.dataAttribute,e.value),t.innerHTML=`\n\t\t\t\t\t${e.text}\n\t\t\t\t\t<span class="dashicons dashicons-no-alt" data-name="close-box"></span>\n\t\t\t\t`,c.appendChild(t)}))):c.innerHTML=`\n\t\t\t\t<span class="placeholder">${s.placeholder}</span>\n\t\t\t\t<span class="dashicons dashicons-arrow-down"></span>\n\t\t\t`};m(),r.addEventListener("click",(e=>{if(!e.target.classList.contains("searchable")&&(r.classList.toggle("open"),r.classList.contains("open"))){const e=r.querySelector(".searchable");e&&setTimeout((()=>{e.focus()}),10)}})),d.addEventListener("click",(e=>{const t=e.target.closest("li");if(t&&!t.classList.contains("message")&&!t.classList.contains("loading")){const e=t.getAttribute("data-value"),a=i.querySelector(`option[value="${e}"]`);a&&(a.selected=!a.selected,t.classList.toggle("selected"),m())}})),c.addEventListener("click",(e=>{const t=e.target.closest('[data-name="close-box"]');if(t){e.stopPropagation();const a=t.closest(".value").getAttribute(s.dataAttribute),n=i.querySelector(`option[value="${a}"]`);if(n){n.selected=!1;const e=d.querySelector(`li[data-value="${a}"]`);e&&e.classList.remove("selected"),m()}}}));const b=function(e,t){let i;return function(...a){const n=this;clearTimeout(i),i=setTimeout((()=>e.apply(n,a)),t)}}((function(e){!function(e){const t=l.querySelector(".search-status");t.textContent=window.bricksData?.i18n?.searching,t.classList.add("active");const a=document.createElement("li");a.className="loading",a.innerHTML=`<span>${window.bricksData?.i18n?.searching}</span>`;const n=Array.from(d.querySelectorAll("li.selected"));d.innerHTML="",n.forEach((e=>d.appendChild(e))),d.appendChild(a);const r={action:s.ajaxOptions.action,search:e,...s.ajaxOptions.params};window.bricksData?.nonce&&(r.nonce=window.bricksData.nonce),jQuery.ajax({type:"GET",url:window.bricksData?.ajaxUrl,data:r,success:function(e){if(d.querySelectorAll("li.loading").forEach((e=>e.remove())),t.textContent="",t.classList.remove("active"),e.success&&e.data){const t=Array.from(i.selectedOptions).map((e=>e.value));Object.entries(e.data).forEach((([e,a])=>{if(!i.querySelector(`option[value="${e}"]`)){const n=document.createElement("option");n.value=e,n.text=a,n.selected=t.includes(e),i.appendChild(n)}}));const a=Array.from(d.querySelectorAll("li.selected"));if(d.innerHTML="",a.forEach((e=>d.appendChild(e))),Object.entries(e.data).forEach((([e,i])=>{if(d.querySelector(`li[data-value="${e}"]`))return;const a=document.createElement("li");a.setAttribute("data-value",e),a.className=t.includes(e)?"selected":"",a.innerHTML=`<span>${i}</span>`,d.appendChild(a)})),0===d.children.length){const e=document.createElement("li");e.className="message",e.innerHTML=`<span>${window.bricksData?.i18n?.noResults}</span>`,d.appendChild(e)}}else{const e=document.createElement("li");e.className="message error",e.innerHTML=`<span>${window.bricksData?.i18n?.searchError}</span>`,d.appendChild(e)}},error:function(){d.querySelectorAll("li.loading").forEach((e=>e.remove())),t.textContent="",t.classList.remove("active");const e=document.createElement("li");e.className="message error",e.innerHTML=`<span>${window.bricksData?.i18n?.searchError}</span>`,d.appendChild(e)}})}(e)}),s.ajaxOptions.debounceTime);l.querySelector(".searchable").addEventListener("input",(e=>{const t=e.target.value.toLowerCase();if(s.ajaxSearch){if(d.querySelectorAll("li.message").forEach((e=>e.remove())),""===t){if(u(),0===d.children.length){const e=document.createElement("li");e.className="message",e.innerHTML=`<span>${window.bricksData?.i18n?.typeToSearch}</span>`,d.appendChild(e)}return}if(t.length>=s.ajaxOptions.minSearchLength)b(t);else if(t.length>0){const e=document.createElement("li");e.className="message",e.innerHTML=`<span>${window.bricksData?.i18n?.minSearchLength}</span>`;const t=Array.from(d.querySelectorAll("li.selected"));d.innerHTML="",t.forEach((e=>d.appendChild(e))),d.appendChild(e)}}else Array.from(d.children).forEach((e=>{const i=e.textContent.toLowerCase();e.style.display=i.includes(t)?"":"none"}))})),document.addEventListener("click",(e=>{r.contains(e.target)||r.classList.remove("open")}))}function bricksElementManger(){let e=document.getElementById("bricks-element-manager");e&&(elementFilters=document.querySelectorAll("button[data-filter-by]"),elementFilters.forEach((t=>{t.addEventListener("click",(function(i){i.preventDefault();let a=i.target.classList.contains("active"),n=t.dataset.filterBy,s=i.target.querySelector("i");s&&(a?(s.classList.remove("dashicons-remove"),s.classList.add("dashicons-insert")):(s.classList.remove("dashicons-insert"),s.classList.add("dashicons-remove"))),a?(t.classList.remove("button-primary"),t.classList.add("button-scondary")):(t.classList.remove("button-secondary"),t.classList.add("button-primary")),a?("unused"===n&&delete e.dataset.filterUnused,"native"===n&&delete e.dataset.filterNative,"custom"===n&&delete e.dataset.filterCustom):("unused"===n&&(e.dataset.filterUnused="on"),"native"===n&&(e.dataset.filterNative="on"),"custom"===n&&(e.dataset.filterCustom="on")),t.classList.toggle("active")}))})),e.addEventListener("click",(function(t){if(t.target.dataset.status){let i=e.querySelector(".submit-wrapper");i&&i.classList.add("sticky"),Array.from(t.target.parentNode.children).forEach((e=>{e.classList.remove("current")})),t.target.classList.add("current");let a=t.target.closest("tr");a&&(a.dataset.status=t.target.dataset.status)}let i=t.target.closest(".element-permission input");if(i)if("all"===i.value){i.closest("tr").querySelectorAll(".element-permission input").forEach((e=>{"all"!==e.value&&(e.checked=i.checked)}))}else if(i.checked){let e=i.closest("tr"),t=e.querySelectorAll(".element-permission input"),a=!0;if(t.forEach((e=>{"all"===e.value||e.checked||(a=!1)})),a){let t=e.querySelector('.element-permission input[value="all"]');t&&(t.checked=!0)}}else{let e=i.closest("tr").querySelector('.element-permission input[value="all"]');e&&(e.checked=!1)}})),e.addEventListener("submit",(function(t){t.preventDefault();let i={};e.querySelectorAll("tbody tr").forEach((e=>{let t=e.dataset.name,a=e.dataset.status;i[t]={status:a,permission:[]},e.querySelectorAll(".element-permission input:checked").forEach((e=>{i[t].permission.push(e.value)}))}));let a="reset"===document.activeElement.getAttribute("name");if(a){if(!confirm("Are you sure you want to reset the element manager?"))return}jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_save_element_manager",elements:i,nonce:bricksData.nonce,reset:a},beforeSend:()=>{e.classList.add("wait")},success:function(){if(e.classList.remove("wait"),a)alert("Element manager has been reset."),location.reload();else{alert("Element manager has been saved.");let t=e.querySelector(".submit-wrapper");t&&t.classList.remove("sticky")}}})})))}function bricksAdminElementManagerUsage(){if(!document.getElementById("bricks-element-manager"))return;let e=[],t=!1;document.querySelectorAll(".element-usage").forEach((t=>{const i=t.dataset.elementName;i&&e.push(i)})),function i(){if(t||0===e.length)return;t=!0,function(e){const t=new FormData;t.append("action","bricks_get_element_usage_count"),t.append("nonce",bricksData.nonce),t.append("elementNames",e),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_get_element_usage_count",nonce:bricksData.nonce,elementNames:e},success:function(t){const i=t.data?.results||{};e.forEach((e=>{const t=document.querySelector(`.element-usage[data-element-name="${e}"]`);t&&(t.innerHTML=i[e]?.count||"-",t.closest("tr").setAttribute("data-count",i[e]?.count||0))}))}})}(e.splice(0,25)),setTimeout((()=>{t=!1,i()}),200)}()}function bricksAdminCustomCapabilities(){const e=document.querySelector(".bricks-custom-capabilities-wrapper");if(!e)return;const t=e.querySelector(".new-capability"),i=e.querySelector(".bricks-custom-capabilities-list"),a=e.querySelector('input[name="customCapabilities"]');let n=[];if(a&&a.value)try{n=JSON.parse(a.value)}catch(e){console.error("Error parsing capabilities:",e)}function s(e){const t=e.querySelector('.permission-section[data-section="access_builder"]');if(!t)return!1;const i=t.querySelectorAll('input[type="checkbox"][name="permissions[]"]');return Array.from(i).some((e=>e.checked))}function r(e,t){e.querySelectorAll(".permission-section").forEach((e=>{if("access_builder"===e.dataset.section)return;const i=e.querySelectorAll('input[type="checkbox"][name="permissions[]"]'),a=e.querySelector(".enable-all-checkbox");i.forEach((e=>{e.disabled=!t,t||(e.checked=!1)})),a&&(a.disabled=!t,a.checked=t&&Array.from(i).every((e=>e.checked)))}))}function c(){a&&(a.value=JSON.stringify(n))}function o(){if(i.innerHTML="",window.bricksData.defaultCapabilities&&(i.innerHTML+=`<div class="sub">${window.bricksData.i18n.defaultCapabilities}</div>`,Object.entries(window.bricksData.defaultCapabilities).forEach((([e,t])=>{const a=document.createElement("div");a.className="capability-item",a.dataset.capability=e,a.dataset.isDefault="true",a.innerHTML=`\n\t\t\t\t\t<div class="capability-header">\n\t\t\t\t\t\t<div class="capability-name">${t} <em>(${window.bricksData.i18n.default})</em></div>\n\t\t\t\t\t\t<div class="capability-actions">\n\t\t\t\t\t\t\t<button type="button" class="button view-capability">\n\t\t\t\t\t\t\t\t${window.bricksData.i18n.view}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,i.appendChild(a)}))),n.length){let e=document.createElement("hr");e.className="capabilities-separator",i.appendChild(e),i.innerHTML+=`<div class="sub">${window.bricksData.i18n.customCapabilities}</div>`,i.innerHTML+=`<div class="description">${window.bricksData.i18n.customCapabilitiesDescription}</div>`}n.forEach((e=>{const t=document.createElement("div");t.className="capability-item",t.dataset.capability=e.id,t.innerHTML=`\n\t\t\t\t<div class="capability-header">\n\t\t\t\t\t<div class="capability-name">${e.label}</div>\n\t\t\t\t\t<div class="capability-actions">\n\t\t\t\t\t\t<button type="button" class="button edit-capability">\n\t\t\t\t\t\t\t${window.bricksData.i18n.edit}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button type="button" class="button duplicate-capability">\n\t\t\t\t\t\t${window.bricksData.i18n.duplicate}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button type="button" class="button delete-capability">\n\t\t\t\t\t\t${window.bricksData.i18n.delete}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,i.appendChild(t)}))}function l(){const e=document.querySelector(".bricks-capability-modal"),t=document.querySelector(".bricks-capability-modal-backdrop");e&&e.remove(),t&&t.remove()}function d(e,t){const i=e.querySelector('input[name="capability-name"]'),a=e.querySelector('textarea[name="capability-description"]'),s=e.querySelectorAll('input[type="checkbox"][name="permissions[]"]'),r=e.querySelector(".capability-name-error"),l=i.value.trim(),d=a.value.trim();if(!l)return r.textContent=window.bricksData.i18n.capabilityNameRequired,i.classList.add("error"),!1;if(window.bricksData.defaultCapabilities&&Object.keys(window.bricksData.defaultCapabilities).includes(t)&&(!t||l!==t))return r.textContent=window.bricksData.i18n.capabilityNameReserved,i.classList.add("error"),!1;if(n.some((e=>e.id===l&&(!t||l!==t))))return r.textContent=window.bricksData.i18n.capabilityNameExists,i.classList.add("error"),!1;const u=[];if(s.forEach((e=>{e.checked&&u.push(e.value)})),t){const e=n.findIndex((e=>e.id===t));if(-1!==e){if(l!==n[e].label){document.querySelectorAll('select[name^="builderCapabilities"]').forEach((e=>{const i=Array.from(e.options).find((e=>e.value===t));i&&(i.textContent=l)}))}n[e]={id:t,label:l,description:d,permissions:u}}}else{const e=b();n.push({id:e,label:l,description:d,permissions:u}),m({id:e,label:l})}return c(),o(),!0}function u(e,t){const i=function(e,t){let i={id:"",label:"",description:"",permissions:[]};if(e)if(window.bricksData.defaultCapabilityPermissions&&window.bricksData.defaultCapabilityPermissions[e]){const t=window.bricksData.defaultCapabilityPermissions[e];i={id:e,label:t.label,permissions:t.permissions||[]}}else{const t=n.find((t=>t.id===e));t&&(i=t)}const a=window.bricksData.defaultCapabilityPermissions?.[e];return`\n\t\t<div class="bricks-capability-modal">\n\t\t\t<div class="bricks-capability-modal-header">\n\t\t\t\t<h2>${t?window.bricksData.i18n.view:i.id?window.bricksData.i18n.editCapability:window.bricksData.i18n.newCapability}</h2>\n\t\t\t\t<button type="button" class="close-modal">\n\t\t\t\t\t<span class="dashicons dashicons-no-alt"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="bricks-capability-modal-content">\n\t\t\t\t<div class="capability-name-wrapper">\n\t\t\t\t\t<label for="capability-name">${window.bricksData.i18n.capabilityName}</label>\n\t\t\t\t\t<span class="capability-id" title="${window.bricksData.i18n.capability}: ${window.bricksData.i18n.capabilityKey}">${i.id}</span>\n\t\t\t\t\t<input type="text" name="capability-name" id="capability-name" value="${i.label}" ${t||a?"disabled":""}>\n\t\t\t\t\t<div class="capability-name-error"></div>\n\t\t\t\t</div>\n\t\t\t\t${a?"":`\n\t\t\t\t<div class="capability-description-wrapper">\n\t\t\t\t\t<label for="capability-description">${window.bricksData.i18n.description}</label>\n\t\t\t\t\t<textarea name="capability-description"id="capability-description"rows="3"${t?"disabled":""}>${i.description||""}</textarea>\n\t\t\t\t</div>\n\t\t\t\t`}\n\t\t\t\t<div class="capability-permissions">\n\t\t\t\t\t${Object.entries(window.bricksData.builderAccessPermissions).map((([e,a])=>`\n\t\t\t\t\t\t<div class="permission-section"data-section="${e}">\n\t\t\t\t\t\t\t<div class="section-header">\n\t\t\t\t\t\t\t\t<h3>${a.label}</h3>\n\t\t\t\t\t\t\t\t<label class="enable-all-wrapper">\n\t\t\t\t\t\t\t\t\t<input type="checkbox"class="enable-all-checkbox"${t?"disabled":""}>\n\t\t\t\t\t\t\t\t\t<span>${window.bricksData.i18n.enableAll}</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<div class="description">${a.description||""}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="permission-grid">\n\t\t\t\t\t\t\t\t${Object.entries(a.permissions).map((([e,a])=>`\n\t\t\t\t\t\t\t\t\t<label class="permission-item">\n\t\t\t\t\t\t\t\t\t\t<input type="checkbox" name="permissions[]" value="${e}" ${i.permissions.includes(e)?"checked":""} ${t?"disabled":""}>\n\t\t\t\t\t\t\t\t\t\t<span>${a}</span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t`)).join("")}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`)).join("")}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bricks-capability-modal-footer">\n\t\t\t\t<div class="save-reminder">${window.bricksData.i18n.saveSettingsToApplyChanges}</div>\n\t\t\t\t<button type="button" class="button close-modal">${window.bricksData.i18n.close}</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="bricks-capability-modal-backdrop"></div>\n\t\t`}(e,t);document.body.insertAdjacentHTML("beforeend",i);const a=document.querySelector(".bricks-capability-modal"),c=a.querySelectorAll(".close-modal"),o=a.querySelector('input[name="capability-name"]'),u=a.querySelectorAll('input[type="checkbox"][name="permissions[]"]'),m=document.querySelector(".bricks-capability-modal-backdrop");if(c.forEach((i=>{i.addEventListener("click",(()=>{t||d(a,e),l()}))})),m&&m.addEventListener("click",(()=>{t||d(a,e),l()})),document.addEventListener("keydown",(function i(n){"Escape"===n.key&&(t||d(a,e),l(),document.removeEventListener("keydown",i))})),t&&(o&&(o.disabled=!0),u.forEach((e=>{e.disabled=!0}))),!t){const t=s(a);r(a,t);const i=a.querySelector('.permission-section[data-section="access_builder"]');if(i){i.querySelectorAll('input[type="checkbox"][name="permissions[]"]').forEach((t=>{t.addEventListener("change",(()=>{const t=s(a);r(a,t),d(a,e)}))}))}}t||(a.querySelectorAll(".permission-section").forEach((t=>{const i=t.querySelectorAll('input[type="checkbox"][name="permissions[]"]'),n=t.querySelector(".enable-all-checkbox"),c=Array.from(i).every((e=>e.checked));n.checked=c,n.addEventListener("change",(function(){if("access_builder"!==t.dataset.section&&!s(a))return void(this.checked=!1);const n=this.checked;i.forEach((e=>{e.disabled||(e.checked=n)})),"access_builder"===t.dataset.section&&r(a,n),d(a,e)}))})),u.forEach((t=>{t.addEventListener("change",(function(){const t=this.closest(".permission-section"),i=t.querySelectorAll('input[type="checkbox"][name="permissions[]"]'),n=t.querySelector(".enable-all-checkbox"),c=Array.from(i).every((e=>e.checked||e.disabled));if(n.checked=c,"access_builder"===t.dataset.section){const e=s(a);r(a,e)}d(a,e)}))}))),o&&!t&&o.addEventListener("input",(function(){const t=a.querySelector(".capability-name-error");o.classList.remove("error"),t.textContent="",d(a,e)}))}function m(e){const t=document.querySelectorAll('select[name^="builderCapabilities"]');if(!t.length)return;const i=document.createElement("option");i.value=e.id,i.textContent=e.label,t.forEach((t=>{if(t.disabled)return;const a=t.querySelector(`option[value="${e.id}"]`);a&&a.remove();const n=Array.from(t.options).find((e=>"bricks_full_access"===e.value));n?t.insertBefore(i.cloneNode(!0),n):t.appendChild(i.cloneNode(!0))}))}function b(){return`bricks_builder_access_${function(e=6){return Math.random().toString(36).substring(2,2+e)}()}`}function m(e){const t=document.querySelectorAll('select[name^="builderCapabilities"]');if(!t.length)return;const i=document.createElement("option");i.value=e.id,i.textContent=e.label,t.forEach((t=>{if(t.disabled)return;const a=t.querySelector(`option[value="${e.id}"]`);a&&a.remove();const n=Array.from(t.options).find((e=>"bricks_full_access"===e.value));n?t.insertBefore(i.cloneNode(!0),n):t.appendChild(i.cloneNode(!0))}))}t&&t.addEventListener("click",(function(){const e={id:b(),label:window.bricksData.i18n.newCapability,permissions:[]};n.push(e),c(),m(e),o(),u(e.id)})),o(),i&&i.addEventListener("click",(function(e){const t=e.target.closest(".capability-item");if(!t)return;const i=t.dataset.capability;if(e.target.classList.contains("view-capability"))u(i,!0);else if(e.target.classList.contains("edit-capability"))u(i);else if(e.target.classList.contains("duplicate-capability")||e.target.closest(".duplicate-capability")){const e=n.find((e=>e.id===i));if(e){const t={id:b(),label:`${e.label} (${window.bricksData.i18n.duplicate})`,description:e.description||"",permissions:[...e.permissions]};n.push(t),c(),m(t),o()}}else if(e.target.classList.contains("delete-capability")||e.target.closest(".delete-capability")){if(confirm(window.bricksData.i18n.confirmDeleteCapability)){n=n.filter((e=>e.id!==i));document.querySelectorAll('select[name^="builderCapabilities"]').forEach((e=>{const t=e.querySelector(`option[value="${i}"]`);t&&t.remove()})),c(),o()}}}))}function bricksAdminTemplateExclusion(){bricksCreateMultiselect("excludedTemplates",{placeholder:window.bricksData?.i18n?.selectTemplates,searchPlaceholder:window.bricksData?.i18n?.searchTemplates,dataAttribute:"data-template-id"})}function bricksAdminMaintenanceExcludedPosts(){bricksCreateMultiselect("maintenanceExcludedPosts",{placeholder:window.bricksData?.i18n?.selectPosts,searchPlaceholder:window.bricksData?.i18n?.searchPosts,dataAttribute:"data-post-id",ajaxSearch:!0,ajaxOptions:{action:"bricks_get_posts",params:{postType:"any",postStatus:"publish",excludePostTypes:["bricks_template","attachment"]},minSearchLength:2,debounceTime:300}})}function bricksAttributeImageSwatches(){document.addEventListener("click",(function(e){if(!e.target.matches(".bricks_swatch_image_upload"))return;e.preventDefault();const t=e.target,i=t.parentNode,a=i.querySelector('input[name="swatch_image_value"], input[name="swatch_default_image"]'),n=i.querySelector(".swatch-image-preview");let s=window.wp;s.media.frames.file_frame||(s.media.frames.file_frame=s.media({multiple:!1})),s.media.frames.file_frame.off("select").on("select",(function(){const e=s.media.frames.file_frame.state().get("selection").first().toJSON();if(a.value=e.id,n)n.src=e.url;else{const i=document.createElement("img");i.src=e.url,i.className="swatch-image-preview",i.style.cssText="max-width: 150px; display: block; margin-bottom: 8px;",t.parentNode.insertBefore(i,t)}t.nextElementSibling.style.display=""})),s.media.frames.file_frame.open()})),document.addEventListener("click",(function(e){if(!e.target.matches(".bricks_swatch_image_remove"))return;e.preventDefault();const t=e.target,i=t.parentNode,a=i.querySelector('input[name="swatch_image_value"], input[name="swatch_default_image"]'),n=i.querySelector(".swatch-image-preview");a.value="",n&&n.remove(),t.style.display="none"}))}function bricksAttributeColorSwatches(){document.addEventListener("click",(function(e){if(!e.target.matches(".bricks-remove-color"))return;e.preventDefault();const t=e.target.dataset.input,i=document.getElementById(t);i.closest(".bricks-color-swatch-wrapper").innerHTML=`\n\t\t\t<div style="display: inline-block">\n\t\t\t\t<button type="button" class="button show-color-picker" data-input-id="${t}">\n\t\t\t\t\t${window.bricksData.i18n.selectColor}\n\t\t\t\t</button>\n\t\t\t\t<input type="hidden" name="${i.name}" id="${t}" value="none">\n\t\t\t</div>\n\t\t`})),document.addEventListener("click",(function(t){if(!t.target.matches(".show-color-picker"))return;const i=t.target.dataset.inputId,a="swatch_default_color"===i?"swatch_default_color":"swatch_color_value";t.target.closest("div").outerHTML=`\n\t\t\t<div class="bricks-color-input-wrapper" style="position: relative; display: inline-block;">\n\t\t\t\t<input type="color" name="${a}" id="${i}" class="bricks-color-input">\n\t\t\t\t<button type="button" class="button bricks-remove-color" data-input="${i}">\n\t\t\t\t\t${window.bricksData.i18n.remove}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;const n=document.getElementById(i);e(t,n)||(n.focus(),setTimeout((()=>{n.click()}),10))})),document.addEventListener("click",(function(t){t.target.matches('input[type="color"].bricks-color-input')&&e(t,t.target)}));const e=(e,t)=>{if(-1!==navigator.userAgent.indexOf("Chrome")){const i=t.value||"#ffffff",a=document.createElement("input");return a.type="color",a.value=i,a.style.position="absolute",a.style.left=e.pageX-5+"px",a.style.top=e.pageY-5+"px",a.style.padding="0",a.style.margin="0",a.style.width="1px",a.style.height="1px",a.style.opacity="0.01",a.style.pointerEvents="none",a.style.zIndex="999999",a.addEventListener("input",(function(){t.value=a.value})),a.addEventListener("change",(function(){t.value=a.value,document.body.removeChild(a)})),document.body.appendChild(a),a.focus(),a.click(),!0}return!1}}function bricksAttributeSwatchTypeVisibility(){const e=document.getElementById("swatch_type"),t=document.querySelectorAll(".bricks-swatch-fallback");function i(){const i=e.value;if(t.forEach((e=>{e.style.display="none"})),i){const e=document.querySelector(".bricks-swatch-fallback-"+i);e&&(e.style.display="")}}e&&(e.addEventListener("change",i),i())}function bricksCleanupOrphanedElements(){let e=document.getElementById("cleanup-all-orphaned-elements");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.i18n.confirmCleanupOrphanedElements)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_cleanup_orphaned_elements",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),t.success?(alert(t.data.message),location.reload()):alert(t.data.message||bricksData.i18n.errorOccurred)},error:function(){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(bricksData.i18n.errorOccurredCleaningUpOrphanedElements)}})}))}function bricksScanOrphanedElements(){let e=document.getElementById("scan-orphaned-elements"),t=document.getElementById("orphaned-elements-results");e&&t&&e.addEventListener("click",(function(i){i.preventDefault(),jQuery.ajax({type:"POST",url:window.bricksData.ajaxUrl,data:{action:"bricks_scan_orphaned_elements",nonce:window.bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(i){e.removeAttribute("disabled"),e.classList.remove("wait"),i.success?bricksDisplayOrphansScanResults(i.data,t):alert(i.data.message||window.bricksData.i18n.error)},error:function(){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(window.bricksData.i18n.errorOccurredScanningOrphanedElements)}})}))}function bricksDisplayOrphansScanResults(e,t){let i="";if(0===e.total_orphans)i='<div class="separator"></div>',i+='<p class="message success"><strong>'+window.bricksData.i18n.noOrphanedElementsFound+"</strong></p>";else{i='<div class="separator"></div>';let t=window.bricksData.i18n.orphanedElementsFoundMessage.replace("%1$d",e.total_orphans).replace("%2$d",e.total_posts);i+='<h3 class="hero">'+window.bricksData.i18n.results+": "+window.bricksData.i18n.orphanedElementsReview+"</h3>",i+='<p class="message error"><strong>'+t+"</strong></p>",i+='<div class="actions-wrapper" style="margin: 15px 0;">',i+='<button type="button" id="cleanup-all-orphaned-elements" class="ajax button button-primary" style="margin-right: 10px;">',i+='<span class="text">'+window.bricksData.i18n.cleanupAllOrphanedElements+"</span>",i+='<span class="spinner is-active"></span>',i+='<i class="dashicons dashicons-yes hide"></i>',i+="</button>",i+="</div>",i+='<div class="orphaned-posts-list">',i+="<ul>";for(let t in e.orphaned_by_post_id){let a,n=e.orphaned_by_post_id[t],s=n.permalink;a=-1===s.indexOf("?")?`${s}?${window.bricksData.builderParam}=run`:`${s}&${window.bricksData.builderParam}=run`,i+="<li>",i+='<a href="'+a+'" target="_blank">',i+="<strong>"+n.post_title+"</strong>",i+="</a>",i+=" - ",i+='<span style="color: #d63638;">',i+=window.bricksData.i18n.orphanedElementsCountMessage.replace("%d",n.total_orphans),i+="</span>",i+="</li>"}i+="</ul>",i+="</div>"}t.innerHTML=i,t.style.display="block",e.total_orphans>0&&bricksCleanupOrphanedElements()}document.addEventListener("DOMContentLoaded",(function(e){bricksAdminClassicEditor(),bricksAdminImport(),bricksAdminSaveLicenseKey(),bricksAdminToggleLicenseKey(),bricksAdminSettings(),bricksAdminRunConverter(),bricksAdminBreakpointsRegenerateCssFiles(),bricksAdminGenerateCssFiles(),bricksAdminCodeReview(),bricksAdminCodeReviewFilter(),bricksAdminCustomCapabilities(),bricksAdminGlobalElementsReview(),bricksTemplateShortcodeCopyToClipboard(),bricksDismissHttpsNotice(),bricksDismissInstagramAccessTokenNotice(),bricksDropFormSubmissionsTable(),bricksResetFormSubmissionsTable(),bricksDeleteFormSubmissionsByFormId(),bricksRemoteTemplateUrls(),bricksDeleteTemplateScreenshots(),bricksReindexFilters(),bricksRunIndexJob(),bricksFixElementDB(),bricksRegenerateCodeSignatures(),bricksCleanupOrphanedElements(),bricksScanOrphanedElements(),bricksAdminGlobalElementsReview(),bricksTemplateThumbnailAddScrollAnimation(),bricksAdminMaintenanceTemplateListener(),bricksAdminAuthUrlBehaviorListener(),bricksAdminWooSettings(),bricksAdminTemplateExclusion(),bricksAdminMaintenanceExcludedPosts(),bricksElementManger(),bricksAdminElementManagerUsage(),bricksAttributeImageSwatches(),bricksAttributeColorSwatches(),bricksAttributeSwatchTypeVisibility();let t=document.querySelector(".wp-list-table-container"),i=document.querySelector(".tablenav.top"),a=document.querySelector(".tablenav.bottom");t&&i&&t.parentNode.insertBefore(i,t),t&&a&&t.parentNode.insertBefore(a,t.nextSibling);let n=document.getElementById("bricks-form-submissions"),s=!!n&&n.querySelector(".search-box input[type=search]");s&&(s.placeholder=window.bricksData?.i18n.formSubmissionsSearchPlaceholder)}));